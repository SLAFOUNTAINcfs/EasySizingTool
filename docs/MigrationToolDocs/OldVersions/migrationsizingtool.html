<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Azure Application Migration Sizing Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 1.5rem;
      background: #0b1120;
      color: #e5e7eb;
    }
    h1, h2, h3 {
      color: #f9fafb;
      margin-top: 0.5rem;
      margin-bottom: 0.5rem;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    .card {
      background: #020617;
      border: 1px solid #1f2937;
      border-radius: 0.75rem;
      padding: 1rem 1.25rem;
      margin-bottom: 1rem;
      box-shadow: 0 10px 25px rgba(0,0,0,0.4);
    }
    label {
      font-size: 0.9rem;
      display: block;
      margin-bottom: 0.25rem;
    }
    input, select {
      background: #020617;
      color: #e5e7eb;
      border: 1px solid #374151;
      border-radius: 0.5rem;
      padding: 0.25rem 0.5rem;
      font-size: 0.9rem;
      width: 100%;
      box-sizing: border-box;
    }
    input:focus, select:focus {
      outline: 2px solid #38bdf8;
      outline-offset: 1px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    th, td {
      border-bottom: 1px solid #1f2937;
      padding: 0.35rem 0.4rem;
      vertical-align: top;
    }
    th {
      text-align: left;
      background: #020617;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    .desc {
      color: #9ca3af;
      font-size: 0.8rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 0.75rem;
    }
    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.75rem;
    }
    .pill {
      display: inline-block;
      padding: 0.1rem 0.45rem;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid #4b5563;
      background: #020617;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.4rem 0.8rem;
      border-radius: 999px;
      border: 1px solid #38bdf8;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .btn:hover {
      background: #0b1120;
    }
    .result-value {
      font-size: 1.1rem;
      font-weight: 600;
      color: #22c55e;
    }
    .result-label {
      font-size: 0.8rem;
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .badge-xs { color: #38bdf8; border-color: #38bdf8; }
    .badge-s  { color: #22c55e; border-color: #22c55e; }
    .badge-m  { color: #eab308; border-color: #eab308; }
    .badge-l  { color: #f97316; border-color: #f97316; }
    .badge-xl { color: #ef4444; border-color: #ef4444; }
    .badge-xxl { color: #a855f7; border-color: #a855f7; }
    .badge-xxxl { color: #fb7185; border-color: #fb7185; }
    .muted {
      color: #6b7280;
      font-size: 0.8rem;
    }
    .scroll-x {
      overflow-x: auto;
    }
    .tooltip-icon {
      display: inline-block;
      margin-left: 0.25rem;
      font-size: 0.8rem;
      cursor: help;
      color: #9ca3af;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Azure Application Migration Sizing Tool</h1>
  <p class="muted">
    Rate each factor from <strong>1 (Very Low)</strong> to <strong>5 (Very High)</strong>. Adjust weights and cost model as needed. 
    The tool will compute a weighted score, size bucket, effort (days &amp; hours), person-sprints, sprints with your team, and cost estimate.
  </p>

  <!-- 1. Application Meta -->
  <div class="card">
    <h2>1. Application Meta</h2>
    <div class="grid">
      <div>
        <label for="appName">Application Name</label>
        <input id="appName" type="text" placeholder="e.g., Claims API" />
      </div>
      <div>
        <label for="missionOwner">Mission Owner</label>
        <input id="missionOwner" type="text" placeholder="e.g., Claims Ops" />
      </div>
      <div>
        <label for="technicalOwner">Technical POC</label>
        <input id="technicalOwner" type="text" placeholder="e.g., John Doe" />
      </div>
      <div>
        <label for="missionCriticality">
          Mission Criticality (1–5)
          <span
            class="tooltip-icon"
            title="How important this app is to the business: 1 = nice-to-have, 3 = important, 5 = mission-critical. This doesn’t change the effort, but helps with prioritization."
          >ⓘ</span>
        </label>
        <select id="missionCriticality">
          <option value="">–</option>
          <option value="1">1 – Mission Enable</option>
          <option value="2">2 – Mission Essential</option>
          <option value="3">3 – Mission Critical</option>
        </select>
      </div>
      <div>
        <label for="migrationType">
          Migration Type
          <span
            class="tooltip-icon"
            title="Intended migration approach: Lift & Shift (minimal change), Replatform (move + some changes), Refactor (significant redesign), Replace (new system), or Retire (turn it off)."
          >ⓘ</span>
        </label>
        <select id="migrationType">
          <option value="">–</option>
          <option>Move as is, Lift &amp; Shift</option>
          <option>Make moderate changes, Replatform</option>
          <option>Significant redesign, Refactor</option>
          <option>New system, Replace</option>
          <option>No longer needed, Retire</option>
        </select>
      </div>
      <div>
        <label for="deliverySpeed">
          Delivery Speed
          <span
            class="tooltip-icon"
            title="Select the desired speed for migration delivery. Impacts team composition and service package."
          >ⓘ</span>
        </label>
        <select id="deliverySpeed">
          <option value="base">Base Development Speed</option>
          <option value="medium">Medium Development Speed</option>
          <option value="moq">MOQ Development Speed</option>
        </select>
      </div>
    </div>
  </div>

  <!-- 2. Effort & Cost Model -->
  <div class="card">
    <h2>2. Effort &amp; Cost Model</h2>
    <div class="grid">
      <div>
        <label for="basePersonDays">
          Base Person-Days per Score Point
          <span
            class="tooltip-icon"
            title="How many person-days of effort you expect for each 1 point of total weighted score. Higher = more effort per unit of complexity. Tune this using historical migration data."
          >ⓘ</span>
        </label>
        <!-- you can set this to 0.3 or 0.6 as you prefer -->
        <input id="basePersonDays" type="number" step="0.1" value="0.3" />
        <p class="muted">Person-days per 1 point of weighted score.</p>
      </div>
      <div>
        <label for="dailyRate">
          Daily Rate (USD)
          <span
            class="tooltip-icon"
            title="Blended cost of one person-day of work (e.g., ~8 hours) including salary, benefits, and overhead. Used to convert effort into estimated migration cost."
          >ⓘ</span>
        </label>
        <input id="dailyRate" type="number" step="50" value="200" />
        <p class="muted">Blended cost per person-day.</p>
      </div>
      <div>
        <label for="workDaysPerMonth">
          Work Days per Month
          <span
            class="tooltip-icon"
            title="How many working days you assume in a typical month. Used only for internal calibration and sanity checks."
          >ⓘ</span>
        </label>
        <input id="workDaysPerMonth" type="number" step="1" value="20" />
        <p class="muted">Reference value for planning.</p>
      </div>
      <div>
        <label for="hoursPerDay">
          Hours per Work Day
          <span
            class="tooltip-icon"
            title="How many hours count as one full workday for planning (e.g., 6 or 8). Used to convert person-days into total hours and sprint-hours."
          >ⓘ</span>
        </label>
        <input id="hoursPerDay" type="number" step="0.5" value="6" />
        <p class="muted">Used to convert person-days to hours.</p>
      </div>
      <div>
        <label for="sprintHours">
          Sprint Hours per Person
          <span
            class="tooltip-icon"
            title="Number of hours a single person is expected to contribute in one sprint. In your case, 60 hours per sprint per person."
          >ⓘ</span>
        </label>
        <input id="sprintHours" type="number" step="1" value="60" />
        <p class="muted">Hours of one person’s work in a sprint.</p>
      </div>
      <div>
        <label for="teamMembers">
          Team Members Available
          <span
            class="tooltip-icon"
            title="How many people will actually be working on this migration. Used to convert person-sprints into calendar sprints."
          >ⓘ</span>
        </label>
        <input id="teamMembers" type="number" step="1" value="3" />
        <p class="muted">People assigned to this migration.</p>
      </div>

      <!-- XS–XXXL thresholds -->
      <div>
        <label for="xsThreshold">
          XS Threshold
          <span
            class="tooltip-icon"
            title="If the total weighted score is below this value, the app is classified as Extra Small (XS)."
          >ⓘ</span>
        </label>
        <input id="xsThreshold" type="number" step="1" value="75" />
        <p class="muted">Score &lt; XS = XS.</p>
      </div>
      <div>
        <label for="sThreshold">
          S Threshold
          <span
            class="tooltip-icon"
            title="If the score is greater than or equal to the XS threshold but below this value, the app is Small (S)."
          >ⓘ</span>
        </label>
        <input id="sThreshold" type="number" step="1" value="116" />
        <p class="muted">XS ≤ Score &lt; S = S.</p>
      </div>
      <div>
        <label for="mThreshold">
          M Threshold
          <span
            class="tooltip-icon"
            title="If the score is greater than or equal to the S threshold but below this value, the app is Medium (M)."
          >ⓘ</span>
        </label>
        <input id="mThreshold" type="number" step="1" value="231" />
        <p class="muted">S ≤ Score &lt; M = M.</p>
      </div>
      <div>
        <label for="lThreshold">
          L Threshold
          <span
            class="tooltip-icon"
            title="If the score is greater than or equal to the M threshold but below this value, the app is Large (L)."
          >ⓘ</span>
        </label>
        <input id="lThreshold" type="number" step="1" value="346" />
        <p class="muted">M ≤ Score &lt; L = L.</p>
      </div>
      <div>
        <label for="xlThreshold">
          XL Threshold
          <span
            class="tooltip-icon"
            title="If the score is greater than or equal to the L threshold but below this value, the app is Extra Large (XL)."
          >ⓘ</span>
        </label>
        <input id="xlThreshold" type="number" step="1" value="461" />
        <p class="muted">L ≤ Score &lt; XL = XL.</p>
      </div>
      <div>
        <label for="xxlThreshold">
          XXL Threshold
          <span
            class="tooltip-icon"
            title="If the score is greater than or equal to the XL threshold but below this value, the app is XXL. Anything above this is XXXL (massive migration)."
          >ⓘ</span>
        </label>
        <input id="xxlThreshold" type="number" step="1" value="576" />
        <p class="muted">XL ≤ Score &lt; XXL = XXL, else XXXL.</p>
      </div>
    </div>
  </div>

  <!-- 3. Complexity Factors -->
  <div class="card">
    <h2>3. Complexity Factors</h2>
    <p class="muted">
      Adjust the <strong>Weight</strong> (importance) for your organization. Use the <strong>Rating</strong> dropdown to score this specific application.
    </p>
<!--
    <div class="scroll-x">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Factor</th>
            <th>Description</th>
            <th style="width:90px;">Weight (1–10)</th>
            <th style="width:90px;">Rating (1–5)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>F1</td>
            <td>Application size &amp; complexity</td>
            <td class="desc">Codebase size, modules, custom logic, legacy tech.</td>
            <td><input id="weight-1" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-1">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F2</td>
            <td>Number of integrations / interfaces</td>
            <td class="desc">Downstream/upstream systems, APIs, file feeds, queues.</td>
            <td><input id="weight-2" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-2">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F3</td>
            <td>Data volume</td>
            <td class="desc">Total data size to migrate (DB + files).</td>
            <td><input id="weight-3" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-3">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F4</td>
            <td>Database complexity</td>
            <td class="desc">Stored procs, triggers, cross-DB dependencies, vendor features.</td>
            <td><input id="weight-4" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-4">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F5</td>
            <td>Authentication &amp; authorization</td>
            <td class="desc">IdP, SSO, RBAC, custom auth flows.</td>
            <td><input id="weight-5" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-5">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F6</td>
            <td>Security &amp; compliance requirements</td>
            <td class="desc">Regulated data, special controls (PCI, HIPAA, CJIS, etc.).</td>
            <td><input id="weight-6" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-6">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F7</td>
            <td>Availability &amp; DR requirements</td>
            <td class="desc">SLAs, RTO/RPO, multi-region, failover needs.</td>
            <td><input id="weight-7" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-7">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F8</td>
            <td>Performance &amp; scalability requirements</td>
            <td class="desc">Expected load, autoscale, caching, tuning.</td>
            <td><input id="weight-8" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-8">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F9</td>
            <td>Refactoring / modernization level</td>
            <td class="desc">Lift &amp; shift vs replatform vs full refactor.</td>
            <td><input id="weight-9" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-9">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F10</td>
            <td>On-prem / external dependencies</td>
            <td class="desc">Coupling to local services, file shares, hardware, etc.</td>
            <td><input id="weight-10" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-10">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F11</td>
            <td>Environment count</td>
            <td class="desc">Number of environments to stand up (dev/test/QA/UAT/prod).</td>
            <td><input id="weight-11" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-11">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F12</td>
            <td>Test effort</td>
            <td class="desc">Automated coverage, regression depth, non-functional tests.</td>
            <td><input id="weight-12" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-12">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F13</td>
            <td>Cutover &amp; rollback complexity</td>
            <td class="desc">Big bang vs phased, rollback, data freeze windows.</td>
            <td><input id="weight-13" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-13">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F14</td>
            <td>Automation &amp; tooling readiness</td>
            <td class="desc">Existing CI/CD, IaC, monitoring, scripts.</td>
            <td><input id="weight-14" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-14">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>F15</td>
            <td>Documentation &amp; knowledge availability</td>
            <td class="desc">Runbooks, architecture docs, SME availability.</td>
            <td><input id="weight-15" type="number" min="1" max="10" step="1" value="5" /></td>
            <td>
              <select id="rating-15">
                <option value="">–</option>
                <option value="1">1 – Very Low</option>
                <option value="2">2 – Low</option>
                <option value="3">3 – Medium</option>
                <option value="4">4 – High</option>
                <option value="5">5 – Very High</option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div style="margin-top:0.75rem; display:flex; gap:0.5rem; flex-wrap:wrap;">
      <button class="btn" type="button" id="recalcBtn">Recalculate</button>
      <button class="btn" type="button" id="resetBtn" style="border-color:#6b7280;color:#e5e7eb;">
        Reset Weights &amp; Model
      </button>
    </div>
  </div>
-->
  <!-- 4. Results -->
  <div class="card">
    <h2>4. Results</h2>
    <div class="results-grid">
      <div>
        <div class="result-label">Total Weighted Score</div>
        <div class="result-value" id="totalScore">0.0</div>
      </div>
      <div>
        <div class="result-label">
          Size Bucket
          <span
            class="tooltip-icon"
            title="Overall migration size: XS, S, M, L, XL, XXL, or XXXL based on the total weighted score and the thresholds defined above."
          >ⓘ</span>
        </div>
        <div>
          <span class="pill" id="sizeBucket">–</span>
        </div>
      </div>
      <div>
        <div class="result-label">Estimated Person-Days</div>
        <div class="result-value" id="estimatedPersonDays">0.0</div>
      </div>
      <div>
        <div class="result-label">Total Effort Hours</div>
        <div class="result-value" id="totalHours">0.0</div>
      </div>
      <div>
        <div class="result-label">
          Person-Sprints Required
          <span
            class="tooltip-icon"
            title="Total person-sprints needed: effort hours divided by sprint hours per person. For example, 180 hours at 60 hours/sprint = 3 person-sprints."
          >ⓘ</span>
        </div>
        <div class="result-value" id="personSprints">0.0</div>
      </div>
      <div>
        <div class="result-label">
          Sprints with Current Team
          <span
            class="tooltip-icon"
            title="Person-sprints required divided by the number of team members. Example: 6 person-sprints with 3 people = 2 calendar sprints."
          >ⓘ</span>
        </div>
        <div class="result-value" id="calendarSprints">0.0</div>
      </div>
      <div>
        <div class="result-label">Estimated Migration Cost (USD)</div>
        <div class="result-value" id="estimatedCost">$0</div>
      </div>
    </div>
    <!-- <p class="muted" style="margin-top:0.75rem;">
      This is a rough planning estimate. Tune the weights and effort model as you gather actual migration data.
    </p> -->
  </div>

  <!-- 5. Service Packages & Team Recommendation -->
  <div class="card">
    <h2>5. Service Packages & Team Recommendation</h2>
    <div id="serviceSummary">
      <!-- Populated by JS -->
    </div>
  </div>
</div>

<script>
(function() {
  const factorCount = 15;
  const defaultWeights = Array(factorCount).fill(5); // default weight 5 for each factor F1–F15
  const defaultRatings = Array(factorCount).fill(5); // default rating 5 for each factor F1–F15
  const defaultModel = {
    basePersonDays: 10,
    dailyRate: 200,
    workDaysPerMonth: 20,
    hoursPerDay: 6,
    sprintHours: 60,
    teamMembers: 6,
    xsThreshold: 75,
    sThreshold: 116,
    mThreshold: 231,
    lThreshold: 376,
    xlThreshold: 461,
    xxlThreshold: 576
  };

  function getNumber(id) {
    const el = document.getElementById(id);
    if (!el) return 0;
    const v = parseFloat(el.value);
    return isNaN(v) ? 0 : v;
  }

  function setBadgeClass(bucket) {
    const el = document.getElementById('sizeBucket');
    el.className = 'pill';
    if (bucket === 'XS') el.classList.add('badge-xs');
    else if (bucket === 'S') el.classList.add('badge-s');
    else if (bucket === 'M') el.classList.add('badge-m');
    else if (bucket === 'L') el.classList.add('badge-l');
    else if (bucket === 'XL') el.classList.add('badge-xl');
    else if (bucket === 'XXL') el.classList.add('badge-xxl');
    else if (bucket === 'XXXL') el.classList.add('badge-xxxl');
  }

  function calculate() {
    let totalScore = 0;
    for (let i = 1; i <= factorCount; i++) {
      const weight = getNumber('weight-' + i);
      const rating = getNumber('rating-' + i);
      totalScore += weight * rating;
    }

    document.getElementById('totalScore').textContent = totalScore.toFixed(1);

    const xsThreshold  = getNumber('xsThreshold');
    const sThreshold   = getNumber('sThreshold');
    const mThreshold   = getNumber('mThreshold');
    const lThreshold   = getNumber('lThreshold');
    const xlThreshold  = getNumber('xlThreshold');
    const xxlThreshold = getNumber('xxlThreshold');

    let bucket = '–';
    if (totalScore > 0) {
      if (totalScore < xsThreshold) bucket = 'XS';
      else if (totalScore < sThreshold) bucket = 'S';
      else if (totalScore < mThreshold) bucket = 'M';
      else if (totalScore < lThreshold) bucket = 'L';
      else if (totalScore < xlThreshold) bucket = 'XL';
      else if (totalScore < xxlThreshold) bucket = 'XXL';
      else bucket = 'XXXL';
    }
    document.getElementById('sizeBucket').textContent = bucket;
    setBadgeClass(bucket);

    const basePersonDays = getNumber('basePersonDays');
    const dailyRate      = getNumber('dailyRate');
    const hoursPerDay    = getNumber('hoursPerDay');
    const sprintHours    = getNumber('sprintHours');
    const teamMembers    = getNumber('teamMembers');

    const personDays = totalScore * basePersonDays;
    const totalHours = personDays * hoursPerDay;
    const cost       = personDays * dailyRate;

    let personSprints = 0;
    if (sprintHours > 0) {
      personSprints = totalHours / sprintHours;
    }

    let calendarSprints = 0;
    if (teamMembers > 0) {
      calendarSprints = personSprints / teamMembers;
    }

    document.getElementById('estimatedPersonDays').textContent = personDays.toFixed(1);
    document.getElementById('totalHours').textContent          = totalHours.toFixed(1);
    document.getElementById('personSprints').textContent       = personSprints.toFixed(2);
    document.getElementById('calendarSprints').textContent     = calendarSprints.toFixed(2);
    document.getElementById('estimatedCost').textContent =
      isNaN(cost) ? '$0' : '$' + Math.round(cost).toLocaleString();

    // --- Fusion Team Recommendation & Service Packages ---
    const serviceSummary = document.getElementById('serviceSummary');
    let effortText = `<strong>Total Effort:</strong> <span>${personDays.toFixed(1)} person-days, ${totalHours.toFixed(1)} hours, ${personSprints.toFixed(2)} person-sprints, ${calendarSprints.toFixed(2)} sprints with your team</span>`;
    let costText = `<strong>Estimated Cost:</strong> <span>${isNaN(cost) ? '$0' : '$' + Math.round(cost).toLocaleString()}</span>`;

    // Delivery speed factor
    const deliverySpeed = document.getElementById('deliverySpeed').value;
    let speedLabel = '';
    let speedDesc = '';
    let speedImpact = 1;
    if (deliverySpeed === 'base') {
      speedLabel = 'Base Development Speed';
      speedDesc = 'Standard delivery timeline. Balanced cost and quality.';
      speedImpact = 1;
    } else if (deliverySpeed === 'medium') {
      speedLabel = 'Medium Development Speed';
      speedDesc = 'Accelerated delivery. May require additional resources or overtime.';
      speedImpact = 1.25;
    } else if (deliverySpeed === 'moq') {
      speedLabel = 'MOQ Development Speed';
      speedDesc = 'Maximum output speed. Highest resource allocation, premium cost.';
      speedImpact = 1.5;
    }

    // Adjust cost and effort for speed
    let speedCost = cost * speedImpact;
    let speedEffort = personDays * speedImpact;
    let speedHours = totalHours * speedImpact;
    let speedPersonSprints = personSprints * speedImpact;
    let speedCalendarSprints = calendarSprints * speedImpact;

    // Fusion team options (speed impacts team suggestion)
    const fusionTeams = [
      {
        name: 'Product Launch Team',
        desc: 'Product Owner, UX/UI Designer, Developer (pro & citizen/low-code), Marketer, QA Tester. For new product launches, combining design, build, marketing, and quality.'
      },
      {
        name: 'New Feature Development Team',
        desc: 'Product Manager, Business Analyst, UX/UI Designer, Developer(s). For developing new features, combining vision, requirements, design, and build.'
      },
      {
        name: 'Digital Operations Team',
        desc: 'IT Operations/Admin, Business Analyst, Data Analyst, Change Management Specialist. For optimizing digital operations and user adoption.'
      }
    ];

    let migrationType = document.getElementById('migrationType').value || '';
    let recommendedTeam = fusionTeams[0]; // Default: Product Launch Team
    if (deliverySpeed === 'moq') {
      // MOQ speed always recommends Product Launch Team for max output
      recommendedTeam = fusionTeams[0];
    } else if (deliverySpeed === 'medium') {
      // Medium speed prefers New Feature Development Team
      recommendedTeam = fusionTeams[1];
    } else {
      // Base speed uses migration type logic
      if (migrationType.includes('Lift')) recommendedTeam = fusionTeams[2]; // Digital Operations Team
      else if (migrationType.includes('Refactor')) recommendedTeam = fusionTeams[1]; // New Feature Development Team
      else if (migrationType.includes('Replace')) recommendedTeam = fusionTeams[0]; // Product Launch Team
    }

    let teamText = `<strong>Recommended Fusion Team:</strong> <span style="font-weight:600;">${recommendedTeam.name}</span><br /><span class="muted">${recommendedTeam.desc}</span>`;
    let speedText = `<strong>Delivery Speed:</strong> <span style="font-weight:600;">${speedLabel}</span><br /><span class="muted">${speedDesc}</span>`;

    // Service packages by bucket and migration type, with speed impact
    let packages = [];
    migrationType = migrationType.toLowerCase();
    if (migrationType.includes('lift')) {
      if (bucket === 'XS' || bucket === 'S') {
        packages.push({
          name: 'Basic Migration',
          desc: 'For small apps with minimal complexity. Includes planning, migration, and basic testing.',
          price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
        });
        packages.push({
          name: 'Standard Migration',
          desc: 'For medium/large apps. Includes planning, migration, testing, and limited refactoring.',
          price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
        });
      } else {
        packages.push({
          name: 'Standard Migration',
          desc: 'For medium/large apps. Includes planning, migration, testing, and limited refactoring.',
          price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
        });
      }
    } else if (migrationType.includes('replatform') || migrationType.includes('refactor')) {
      packages.push({
        name: 'Standard Migration',
        desc: 'For medium/large apps. Includes planning, migration, testing, and limited refactoring.',
        price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
      });
      packages.push({
        name: 'Premium Migration',
        desc: 'For complex or mission-critical apps. Includes full planning, migration, advanced testing, refactoring, and post-migration support.',
        price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
      });
    } else if (migrationType.includes('replace')) {
      packages.push({
        name: 'Premium Migration',
        desc: 'For complex or mission-critical apps. Includes full planning, migration, advanced testing, refactoring, and post-migration support.',
        price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
      });
    } else if (migrationType.includes('retire')) {
      packages.push({
        name: 'Retirement Package',
        desc: 'For apps being decommissioned. Includes planning, data archiving, and system shutdown.',
        price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
      });
    } else {
      if (bucket === 'XS' || bucket === 'S') {
        packages.push({
          name: 'Basic Migration',
          desc: 'For small apps with minimal complexity. Includes planning, migration, and basic testing.',
          price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
        });
      } else if (bucket === 'M' || bucket === 'L') {
        packages.push({
          name: 'Standard Migration',
          desc: 'For medium/large apps. Includes planning, migration, testing, and limited refactoring.',
          price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
        });
      } else if (bucket === 'XL' || bucket === 'XXL' || bucket === 'XXXL') {
        packages.push({
          name: 'Premium Migration',
          desc: 'For complex or mission-critical apps. Includes full planning, migration, advanced testing, refactoring, and post-migration support.',
          price: `<strong>Speed-adjusted Cost:</strong> <span>${isNaN(speedCost) ? '$0' : '$' + Math.round(speedCost).toLocaleString()}</span>`
        });
      }
    }

    let pkgHtml = '<strong>Service Packages:</strong>';
    if (packages.length > 0) {
      pkgHtml += '<ul style="margin-top:0.5rem;">';
      packages.forEach(pkg => {
        pkgHtml += `<li><span style="font-weight:600;">${pkg.name}</span>: ${pkg.desc} <br />${pkg.price}</li>`;
      });
      pkgHtml += '</ul>';
    } else {
      pkgHtml += '<div class="muted">No package available for the current selection.</div>';
    }

    serviceSummary.innerHTML = `<div style="margin-bottom:0.5rem;">${teamText}</div><div style="margin-bottom:0.5rem;">${speedText}</div><div style="margin-bottom:0.5rem;">${effortText}</div><div style="margin-bottom:0.5rem;">${pkgHtml}</div>`;
  }

  function hookInputs() {
    const inputs = document.querySelectorAll('input, select');
    inputs.forEach(el => {
      el.addEventListener('change', calculate);
      el.addEventListener('keyup', calculate);
    });
  }

  function resetDefaults() {
    for (let i = 1; i <= factorCount; i++) {
      const w = document.getElementById('weight-' + i);
      if (w) w.value = defaultWeights[i - 1];
      const r = document.getElementById('rating-' + i);
      if (r) r.value = defaultRatings[i - 1];
    }
    document.getElementById('basePersonDays').value   = defaultModel.basePersonDays;
    document.getElementById('dailyRate').value        = defaultModel.dailyRate;
    document.getElementById('workDaysPerMonth').value = defaultModel.workDaysPerMonth;
    document.getElementById('hoursPerDay').value      = defaultModel.hoursPerDay;
    document.getElementById('sprintHours').value      = defaultModel.sprintHours;
    document.getElementById('teamMembers').value      = defaultModel.teamMembers;
    document.getElementById('xsThreshold').value      = defaultModel.xsThreshold;
    document.getElementById('sThreshold').value       = defaultModel.sThreshold;
    document.getElementById('mThreshold').value       = defaultModel.mThreshold;
    document.getElementById('lThreshold').value       = defaultModel.lThreshold;
    document.getElementById('xlThreshold').value      = defaultModel.xlThreshold;
    document.getElementById('xxlThreshold').value     = defaultModel.xxlThreshold;
    document.getElementById('missionCriticality').value = '3';
    document.getElementById('migrationType').value = 'New system, Replace';
    document.getElementById('deliverySpeed').value = 'moq';
    calculate();
  }

  document.addEventListener('DOMContentLoaded', function() {
    hookInputs();
    document.getElementById('recalcBtn').addEventListener('click', calculate);
    document.getElementById('resetBtn').addEventListener('click', resetDefaults);
    resetDefaults();
  });
})();
</script>
</body>
</html>
